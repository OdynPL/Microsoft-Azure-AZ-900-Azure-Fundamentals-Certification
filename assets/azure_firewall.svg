<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 900 520">
  <defs>
    <linearGradient id="firewallGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#EF4444"/>
      <stop offset="100%" style="stop-color:#B91C1C"/>
    </linearGradient>
    <linearGradient id="vnetGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#3B82F6"/>
      <stop offset="100%" style="stop-color:#1D4ED8"/>
    </linearGradient>
    <linearGradient id="internetGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#10B981"/>
      <stop offset="100%" style="stop-color:#059669"/>
    </linearGradient>
    <linearGradient id="onpremGrad" x1="0%" y1="0%" x2="100%" y2="100%">
      <stop offset="0%" style="stop-color:#8B5CF6"/>
      <stop offset="100%" style="stop-color:#6D28D9"/>
    </linearGradient>
    <marker id="arrowFW" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#6B7280"/>
    </marker>
    <marker id="arrowBlock" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#EF4444"/>
    </marker>
    <marker id="arrowAllow" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto" markerUnits="strokeWidth">
      <path d="M0,0 L0,6 L9,3 z" fill="#10B981"/>
    </marker>
  </defs>
  
  <!-- Title -->
  <text x="450" y="30" text-anchor="middle" font-family="Segoe UI, Arial" font-size="20" font-weight="600" fill="#1E3A5F">Azure Firewall - architektura i przep≈Çyw ruchu</text>
  
  <!-- Internet -->
  <ellipse cx="100" cy="150" rx="70" ry="50" fill="url(#internetGrad)" opacity="0.2" stroke="#10B981" stroke-width="2"/>
  <text x="100" y="145" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="#047857">Internet</text>
  <text x="100" y="165" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#059669">Public IPs</text>
  
  <!-- On-prem -->
  <rect x="30" y="280" width="140" height="80" rx="10" fill="url(#onpremGrad)" opacity="0.2" stroke="#8B5CF6" stroke-width="2"/>
  <text x="100" y="315" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="#6D28D9">On-premises</text>
  <text x="100" y="335" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#7C3AED">VPN / ExpressRoute</text>
  
  <!-- Azure Firewall (central) -->
  <rect x="280" y="100" width="180" height="220" rx="15" fill="url(#firewallGrad)" opacity="0.15" stroke="#EF4444" stroke-width="3"/>
  <rect x="280" y="100" width="180" height="50" rx="15" fill="url(#firewallGrad)"/>
  <rect x="280" y="138" width="180" height="12" fill="url(#firewallGrad)"/>
  <text x="370" y="132" text-anchor="middle" font-family="Segoe UI, Arial" font-size="16" font-weight="600" fill="white">Azure Firewall</text>
  
  <!-- Firewall features -->
  <text x="290" y="175" font-family="Segoe UI, Arial" font-size="10" fill="#374151">L3-L7 Inspection</text>
  <text x="290" y="195" font-family="Segoe UI, Arial" font-size="10" fill="#374151">FQDN Filtering</text>
  <text x="290" y="215" font-family="Segoe UI, Arial" font-size="10" fill="#374151">Threat Intelligence</text>
  <text x="290" y="235" font-family="Segoe UI, Arial" font-size="10" fill="#374151">SNAT / DNAT</text>
  <text x="290" y="255" font-family="Segoe UI, Arial" font-size="10" fill="#374151">TLS Inspection</text>
  <text x="290" y="275" font-family="Segoe UI, Arial" font-size="10" fill="#374151">URL Filtering</text>
  <text x="290" y="295" font-family="Segoe UI, Arial" font-size="10" fill="#374151">Web Categories</text>
  
  <!-- Hub VNet -->
  <rect x="250" y="80" width="240" height="260" rx="20" fill="none" stroke="#3B82F6" stroke-width="2" stroke-dasharray="8,4"/>
  <text x="370" y="355" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" fill="#1E40AF">Hub VNet (AzureFirewallSubnet)</text>
  
  <!-- Spoke VNets -->
  <rect x="550" y="80" width="160" height="100" rx="10" fill="url(#vnetGrad)" opacity="0.15" stroke="#3B82F6" stroke-width="2"/>
  <text x="630" y="110" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="#1E40AF">Spoke VNet 1</text>
  <text x="630" y="130" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#374151">Web Apps</text>
  <rect x="570" y="145" width="50" height="25" rx="4" fill="#DBEAFE" stroke="#3B82F6"/>
  <text x="595" y="162" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#1E40AF">VM</text>
  <rect x="640" y="145" width="50" height="25" rx="4" fill="#DBEAFE" stroke="#3B82F6"/>
  <text x="665" y="162" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#1E40AF">VM</text>
  
  <rect x="550" y="200" width="160" height="100" rx="10" fill="url(#vnetGrad)" opacity="0.15" stroke="#3B82F6" stroke-width="2"/>
  <text x="630" y="230" text-anchor="middle" font-family="Segoe UI, Arial" font-size="12" font-weight="600" fill="#1E40AF">Spoke VNet 2</text>
  <text x="630" y="250" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" fill="#374151">Databases</text>
  <rect x="570" y="265" width="50" height="25" rx="4" fill="#DBEAFE" stroke="#3B82F6"/>
  <text x="595" y="282" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#1E40AF">SQL</text>
  <rect x="640" y="265" width="50" height="25" rx="4" fill="#DBEAFE" stroke="#3B82F6"/>
  <text x="665" y="282" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#1E40AF">CosmosDB</text>
  
  <!-- Arrows -->
  <line x1="175" y1="150" x2="270" y2="180" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowFW)"/>
  <line x1="175" y1="300" x2="270" y2="250" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowFW)"/>
  <line x1="465" y1="180" x2="545" y2="140" stroke="#10B981" stroke-width="2" marker-end="url(#arrowAllow)"/>
  <line x1="465" y1="250" x2="545" y2="250" stroke="#10B981" stroke-width="2" marker-end="url(#arrowAllow)"/>
  
  <!-- Rule Collections Section -->
  <rect x="30" y="390" width="840" height="120" rx="10" fill="#F8FAFC" stroke="#E5E7EB" stroke-width="1"/>
  <text x="450" y="415" text-anchor="middle" font-family="Segoe UI, Arial" font-size="14" font-weight="600" fill="#1E3A5F">Kolekcje regul (Rule Collections) - przetwarzane w kolejnosci priorytetu</text>
  
  <!-- NAT Rules -->
  <rect x="50" y="430" width="200" height="65" rx="8" fill="#FEF3C7" stroke="#F59E0B" stroke-width="2"/>
  <text x="150" y="452" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="#B45309">1. NAT Rules (DNAT)</text>
  <text x="150" y="470" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#374151">Przekierowanie ruchu z Internet</text>
  <text x="150" y="485" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#374151">do wewnetrznych IP</text>
  
  <!-- Network Rules -->
  <rect x="280" y="430" width="200" height="65" rx="8" fill="#DBEAFE" stroke="#3B82F6" stroke-width="2"/>
  <text x="380" y="452" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="#1E40AF">2. Network Rules (L3/L4)</text>
  <text x="380" y="470" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#374151">IP, Port, Protocol</text>
  <text x="380" y="485" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#374151">Allow/Deny ruch sieciowy</text>
  
  <!-- Application Rules -->
  <rect x="510" y="430" width="200" height="65" rx="8" fill="#ECFDF5" stroke="#10B981" stroke-width="2"/>
  <text x="610" y="452" text-anchor="middle" font-family="Segoe UI, Arial" font-size="11" font-weight="600" fill="#047857">3. Application Rules (L7)</text>
  <text x="610" y="470" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#374151">FQDN, URL, Web Categories</text>
  <text x="610" y="485" text-anchor="middle" font-family="Segoe UI, Arial" font-size="9" fill="#374151">HTTP/HTTPS filtering</text>
  
  <!-- Threat Intel -->
  <rect x="740" y="430" width="110" height="65" rx="8" fill="#FEE2E2" stroke="#EF4444" stroke-width="2"/>
  <text x="795" y="452" text-anchor="middle" font-family="Segoe UI, Arial" font-size="10" font-weight="600" fill="#DC2626">Threat Intel</text>
  <text x="795" y="470" text-anchor="middle" font-family="Segoe UI, Arial" font-size="8" fill="#374151">Blokuj znane</text>
  <text x="795" y="485" text-anchor="middle" font-family="Segoe UI, Arial" font-size="8" fill="#374151">malicious IPs</text>
  
  <!-- Priority arrow -->
  <line x1="260" y1="462" x2="275" y2="462" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowFW)"/>
  <line x1="490" y1="462" x2="505" y2="462" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowFW)"/>
  <line x1="720" y1="462" x2="735" y2="462" stroke="#6B7280" stroke-width="2" marker-end="url(#arrowFW)"/>
</svg>